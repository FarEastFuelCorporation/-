<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User 7</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
    <link rel="shortcut icon" href="../images/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/main-css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" />
    <link href="https://fonts.cdnfonts.com/css/script-mt?styles=95594" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <style>
        /* Width of the scrollbar */
        ::-webkit-scrollbar {
        width: 12px;
        }

        /* Handle (the draggable part) */
        ::-webkit-scrollbar-thumb {
        background: #198754; /* Color of the scrollbar handle */
        border-bottom-right-radius: 6px; /* Rounded corners for the handle */
        border-top-right-radius: 5px; /* Rounded corners for the handle */
        }

        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
        background: #dc3545; /* Color of the scrollbar handle on hover */
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="topbar">
            <div class="logo">
                <img src="../images/logo.png" alt="">
                <h2 >FAR EAST FUEL CORPORATION</h2>
            </div>
        </div>
        <div class="sidebar">
            <ul>
                <div id="user_sidebar"></div>
                <div id="user_sidebar_officer"></div>
                <div id="user_sidebar_department"></div>
                <li class="hover">
                    <a href="#">
                        <i class="fas fa-th-large"></i>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-clipboard-list"></i>
                        Logistics Travel Form
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-truck"></i>
                        Vehicles
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-wrench"></i>
                        Vehicle Maintenance
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-cart-shopping"></i>
                        Purchase Requests
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-warehouse"></i>
                        Supplies Warehouse
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-person-falling-burst"></i>
                        Incident Reports
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fas fa-cog"></i>
                        Settings
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fas fa-question"></i>
                        Help
                    </a>
                </li>
                <li>
                    <a href="https://fareastfuelcorporation.github.io/System/">
                        <i class="fa-solid fa-power-off"></i>
                        Logout
                    </a>
                </li>
            </ul>
        </div>
        <div class="main">
            <div class="header_date_time">
                <div class="header_date">
                    <div id="exactDate"></div>
                </div>
                <div class="header_time">
                    <div id="exactTime"></div>    
                </div>
            </div>
            <div class="back_button">
                <button onclick="goBack()">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
            </div>
            <div class="refresh_button">
                <button onclick="refreshPage()">
                    <i class="fa-solid fa-arrows-rotate"></i>
                </button>
            </div>
            <div style="display: flex; position: absolute; top: 60px; right: 20px; z-index: 2; border: 3px solid #dc3545; border-radius: 5px; padding: 5px 20px; background-color: #198754;">
                <label for="month_filter" style="font-weight: bold; color: #ffffff;">FILTER MONTH</label>
                <select name="month_filter" id="month_filter" class="form-control">
                    <option value="ALL">ALL</option>
                    <option value="JANUARY">JANUARY</option>
                    <option value="FEBRUARY">FEBRUARY</option>
                    <option value="MARCH">MARCH</option>
                    <option value="APRIL">APRIL</option>
                    <option value="MAY">MAY</option>
                    <option value="JUNE">JUNE</option>
                    <option value="JULY">JULY</option>
                    <option value="AUGUST">AUGUST</option>
                    <option value="SEPTEMBER">SEPTEMBER</option>
                    <option value="OCTOBER">OCTOBER</option>
                    <option value="NOVEMBER">NOVEMBER</option>
                    <option value="DECEMBER">DECEMBER</option>
                </select>
            </div>
            <button id="generate_report_button" style="display: flex; position: absolute; top: 60px; right: 330px; z-index: 2; border: 3px solid #dc3545; border-radius: 5px; padding: 5px 20px; background-color: #198754;">
                <p style="margin: 0; font-weight: bold; color: white;">GENERATE<br>REPORT</p>
            </button>
            <div id="generate_report_tab" style="display: none;">
                <div style="position: absolute; height: 100%; width: 100%; backdrop-filter: blur(5px); z-index: 2;"></div>
                <div style="position: absolute; padding: 20px; width: 500px; background-color: white; z-index: 2; top: 50%; left: 100px; transform: translate(0, -50%); border-radius: 20px; border: 3px solid #dc3545;">
                    <button id="close_report_button" style="border: none; position: absolute; right: 20px;">
                        <i class="fa-regular fa-rectangle-xmark" style="color: #ff0000;"></i>
                    </button>
                    <h2 style="font-weight: bold; margin: 0;">GENERATE REPORT</h2><br>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;" >
                        <div>
                            <label for="report_date_from">From</label>
                            <input type="date" id="report_date_from" class="form-control" style="border: 3px solid #dc3545;">
                        </div>
                        <div>
                            <label for="report_date_to">To</label>
                            <input type="date" id="report_date_to" class="form-control" style="border: 3px solid #dc3545;">
                        </div>
                    </div><br>
                    <button id="report_generate_button" class="form-control" style="background-color: #198754;">
                        <h4 style="margin: 0; color: white;">Generate</h4>
                    </button>
                    <button onclick="convertToPDF()" id="report_download_button" class="form-control" style="background-color: #198754; display: none;">
                        <h4 style="margin: 0; color: white;">Download</h4>
                    </button>
                </div>
                <input type="hidden" id="page_number" value="1">
                <div id="report_tab_container" style="position: absolute; top: 0; right: 0;">
                    <div id="report_tab1" class="report_tab">
                        <img src="../images/logo.png" alt="logo" style="height: 50px;">
                        <img src="../images/logo_name2.png" alt="logo" style="height: 50px; margin-top: 10px;"><hr>
                        <div style="position: relative;">
                            <h1 style="text-align: center; font-weight: bold; font-size: 32px;">WEEKLY REPORT</h1>
                            <h1 style="text-align: center; font-weight: bold;">DISPATCHING</h1>
                            <h1 style="text-align: center; font-weight: bold;">LOGISTICS DEPARTMENT</h1>
                            <h3 id="date_covered" style="text-align: center;"></h3><br>
                            <div style="display: flex; position: absolute; right: 0; top: 0;">
                                <h6 id="page_counter1" style="margin-right: 5px;"></h6>
                                <h6 style="margin-right: 5px;">of</h6>
                                <h6 id="page_max_counter"></h6>
                            </div>
                        </div>
                        <div id="table_info">
                            <table>
                                <thead id="report_head">
                                    <tr>
                                        <th>LTF #</td>
                                        <th>MTF #</td>
                                        <th>HAULING DATE</th>
                                        <th>DEPARTURE DATE</th>
                                        <th>DEPARTURE TIME</th>
                                        <th>CLIENT</th>
                                        <th>TYPE OF WASTE</th>
                                        <th>TYPE OF VEHICLE</th>
                                        <th>PLATE #</th>
                                    </tr>
                                </thead>
                                <tbody id="report_body"></tbody>
                            </table>
                        </div>
                    </div>
                    <style>
                        .report_tab
                        {
                            width: 1056px;
                            height: 816px;
                            border: 3px solid black;
                            background-color: white;
                            z-index: 4;
                            position: relative;
                            padding: 38px;
                        }
                        
                        .report_tab h1
                        {
                            font-size: 18px;
                            margin: 0;
                        }
    
                        .report_tab h2
                        {
                            font-size: 16px;
                            margin: 0;
                        }
    
                        .report_tab h3
                        {
                            font-size: 14px;
                            margin: 0;
                        }
    
                        .report_tab h4
                        {
                            font-size: 12px;
                            margin: 0;
                        }
    
                        .report_tab h5
                        {
                            font-size: 10px;
                            margin: 0;
                        }
    
                        .report_tab table
                        {
                            width: 100%;
                        }
    
                        .report_tab #report_head tr,
                        .report_tab tbody tr
                        {
                            width: 100%;
                            display: grid;
                            grid-template-columns: 1fr 1fr 1fr 1fr 1fr 3fr 2fr 1fr 1fr;
                        }
    
                        .report_tab #report_head tr th
                        {
                            text-align: center;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            border-top: 1px solid black;
                            border-bottom: 1px solid black;
                            border-right: 1px solid black;
                            font-size: 12px;
                        }
    
                        .report_tab #report_head tr th:first-child
                        {
                            border: 1px solid black;
                        }
    
                        .report_tab tbody tr td
                        {
                            text-align: center;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            border-bottom: 1px solid black;
                            border-right: 1px solid black;
                            font-size: 10px;
                        }
    
                        .report_tab tbody tr td:first-child
                        {
                            border-bottom: 1px solid black;
                            border-right: 1px solid black;
                            border-left: 1px solid black;
                        }
                    </style>
                </div>
            </div>
            <!-- dashboard -->
            <section class="logistic" id="logistic_dashboard">
                <h2>DASHBOARD</h2><br>
                <h2>TRAVEL SUMMARY</h2>
                <div class="cards">
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="booked_transactions"></div>
                            <div class="card-name">Booked Transactions</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-book-bookmark"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="pending_transactions"></div>
                            <div class="card-name">Pending Transaction</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-clipboard-list"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="on_hauling_transactions"></div>
                            <div class="card-name">Ongoing Transactions</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-clipboard-user"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="hauled_transactions"></div>
                            <div class="card-name">Hauled Transactions</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-clipboard-check"></i>
                        </div>
                    </div>
                    <div style="position: relative;">
                        <div id="pieChart" style="position: absolute; margin-top: -40px;">
                        </div>
                    </div>
                </div><br>
                <h2>VEHICLE SUMMARY</h2>
                <div class="cards3" id="vehicle_type_container">
                </div>
                <div class="cards2">
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="available_vehicle"></div>
                            <div class="card-name">Available Vehicles</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-truck"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="on_hauling_vehicle"></div>
                            <div class="card-name">On Hauling</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-truck-ramp-box"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="under_maintenance_vehicle"></div>
                            <div class="card-name">Under Maintenance</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-screwdriver-wrench"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="for_maintenance_vehicle"></div>
                            <div class="card-name">For Maintenance</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-wrench"></i>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="number" id="total_vehicle"></div>
                            <div class="card-name">Total Vehicles</div>
                        </div>
                        <div class="icon-box">
                            <i class="fa-solid fa-truck-moving"></i>
                        </div>
                    </div>
                </div><br>
                <h2>PENDING TRANSACTIONS</h2>
                <div class="table" style="position: relative; max-height: 40vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>MTF #</th>
                                <th>HAULING<br>DATE/TIME</th>
                                <th>CLIENT</th>
                                <th>WASTE<br>CODE</th>
                                <th>WASTE DESCRIPTION</th>
                                <th>TYPE OF VEHICLE</th>
                                <th>REMARKS</th>
                            </thead>
                            <tbody id="pending_list">

                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
                <h2>TRAVEL HISTORY</h2>
                <div class="table" style="max-height: 40vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>LTF #</th>
                                <th>MTF #</th>
                                <th>DEPARTURE<br>DATE/TIME</th>
                                <th>CLIENT</th>
                                <th>WASTE<br>CODE</th>
                                <th>WASTE DESCRIPTION</th>
                                <th>PLATE #</th>
                                <th>DRIVER</th>
                                <th>ARRIVAL<br>DATE/TIME</th>
                                <th>DURATION</th>
                            </thead>
                            <tbody id="ongoing_list">

                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
            </section>
            <!-- LOGISTICS TRAVEL FORM -->
            <section class="logistic" id="logistics_travel_form">
                <h2>LOGISTICS TRAVEL FORM</h2><br>
                <form id="form_id" action="https://script.google.com/macros/s/AKfycbxoTl4vfPp5FGzgzTfE5RE_P1tuZWTblqzDpNmb6GF5TO2D9321Hw04YO8kMwJAOLLl/exec" method="post">
                    <input type="hidden" name="user" id="user">
                    <input type="text" name="mtf_form_no" id="mtf_form_no">
                    <input type="hidden" name="client" id="client">
                    <input type="hidden" name="type_of_waste" id="type_of_waste">
                    <input type="hidden" name="hauling_date" id="hauling_date">
                    <input type="hidden" name="hauling_time" id="hauling_time">
                    <input type="hidden" name="weight" id="weight">
                    <input type="hidden" name="status" id="status" value="ON HAUL">
                    <input type="hidden" name="timestamp" id="timestamp">
                    <div class="ltf_form">
                        <div>
                            <label for="ltf_form_no">
                                <i class="fa-solid fa-list-ol"></i>
                                LTF #
                            </label><br>
                            <div class="form">
                                <input type="text" id="ltf_form_no" autocomplete="off" name="ltf_form_no" class="form-control" readonly><br>
                            </div>
                        </div>
                        <div>
                            <label for="search_ltf_form_no">
                                Search LTF #
                            </label><br>
                            <div class="ltf_form">
                                <div class="form">
                                    <input type="text" id="search_ltf_form_no" autocomplete="off" name="search_ltf_form_no" class="form-control"><br>
                                </div>
                                <div>
                                    <button id="search_ltf_form_no_button" type="button" class="form-control">
                                        <i class="fa-solid fa-magnifying-glass" style="color: #ffffff;"></i>
                                    </button>
                                </div>
                                <div>
                                    <button id="clear_ltf_form_no_button" type="button" class="form-control">
                                        <i class="fa-solid fa-rectangle-xmark" style="color: #ffffff;"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ltf_form">
                        <div>
                            <label for="search_mtf_form_no">
                                <i class="fa-solid fa-list-ol"></i>
                                Search MTF #
                            </label>
                            <div class="ltf_form">
                                <div class="form">
                                    <input type="text" id="search_mtf_form_no" autocomplete="off" name="search_sf_wcf_form_no" class="form-control"><br>
                                </div>
                                <div>
                                    <button id="search_mtf_form_no_button" class="form-control" type="button">
                                        <i class="fa-solid fa-magnifying-glass" style="color: #ffffff;"></i>
                                    </button>
                                </div>
                                <div>
                                    <button id="clear_mtf_form_no_button" type="button" class="form-control">
                                        <i class="fa-solid fa-rectangle-xmark" style="color: #ffffff;"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="search_mtf_result">

                    </div>
                    <div id="ltf_data">
                        <div class="plate_driver_truck_helper" id="plate_driver_truck_helper">
                            <div class="wrapper">
                                <label for="plate_no">
                                    <i class="fa-solid fa-truck"></i>
                                    Plate #
                                </label><br>
                                <div class="search_input" id="search_plate_no">
                                    <input type="text" autocomplete="off" name="plate_no" id="plate_no" class="form-control" required placeholder="Type to Search Plate #...">
                                    <div class="autocom_box">
                                    </div>
                                    <div class="icon"><i class="fas fa-search"></i></div>
                                </div>
                            </div>                         
                            <div class="wrapper">
                                <label for="driver">
                                    <i class="fa-solid fa-id-card"></i>
                                    Driver
                                </label><br>
                                <div class="search_input" id="search_driver">
                                    <input type="text" autocomplete="off" name="driver" id="driver" class="form-control" required placeholder="Type to Search Driver Name...">
                                    <div class="autocom_box">
                                    </div>
                                    <div class="icon"><i class="fas fa-search"></i></div>
                                </div>
                            </div>
                            <div class="add_item pt-3">
                                <div class="item_buttons">
                                    <button type="button" id="remove_item_button" class="form-control">
                                        <i class="fa-solid fa-minus"></i>
                                    </button>
                                    <button type="button" id="add_item_button" class="form-control">
                                        <i class="fa-solid fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <input type="hidden" name="truck_helper_count" id="truck_helper_count" value="1">                         
                            <div class="wrapper">
                                <label for="truck_helper1">
                                    <i class="fa-solid fa-id-card"></i>
                                    Truck Helper 1
                                </label><br>
                                <div class="search_input" id="search_truck_helper">
                                    <input type="text" autocomplete="off" name="truck_helper1" id="truck_helper1" class="form-control" required placeholder="Type to Search Truck Helper Name...">
                                    <div class="autocom_box">
                                    </div>
                                    <div class="icon"><i class="fas fa-search"></i></div>
                                </div>
                            </div>
                        </div><br>
                        <div class="time_in_out">
                            <div class="time_in">
                                <label for="date_departure">
                                    <i class="fa-solid fa-right-to-bracket"></i>
                                    Date of Departure
                                </label>
                                <input type="date" autocomplete="off" name="date_departure" id="date_departure" class="form-control" required>
                            </div>
                            <div class="time_out">
                                <label for="time_departure">
                                <i class="fa-solid fa-right-from-bracket"></i>
                                    Time of Departure
                                </label>
                                <input type="time" autocomplete="off" name="time_departure" id="time_departure" class="form-control" required><br>
                            </div>
                        </div>
                        <label for="remarks">
                            <i class="fa-brands fa-rocketchat"></i>
                            Remarks
                        </label><br>
                        <input class="form-control" autocapitalize="words" autocomplete="off" name="remarks" id="remarks" type="text" placeholder="Type your Remarks"><br>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div>    
                    </div>
                </form>
            </section>
            <!-- vehicle_list_section -->
            <section class="logistic" id="vehicle_list_section">
                <h2>VEHICLES</h2>
                <div>
                    <label class="d-flex gap-3">
                        <button type="button" id="new_vehicle_button" class="form-control fw-bold fs-3 bg-success text-white">
                            NEW VEHICLE FORM
                        </button>
                        <button type="button" id="update_vehicle_button" class="form-control fw-bold fs-3 bg-danger text-white">
                            UPDATE VEHICLE FORM
                        </button>
                    </label><br>
                </div>
                <div id="new_vehicle_tab"  style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <h2>NEW VEHICLE FORM</h2><br>
                    <form action="https://script.google.com/macros/s/AKfycbwtUd1A6MGvhh6axwd9DEiutRi0nePAv2sk5YFe49kH41KxWpy3JL3yFGvGbd7MLGMF/exec" method="post">
                        <label for="plate_no">
                            <i class="fa-regular fa-rectangle-list"></i>
                            Plate #
                        </label><br>
                        <input type="text" autocomplete="off" name="plate_no" id="plate_no" class="form-control form" required placeholder="Input Plate #..."><br>
                        <label for="vehicle">
                            <i class="fa-solid fa-truck"></i>
                            Vehicle
                        </label><br>
                        <input type="text" autocomplete="off" name="vehicle" id="vehicle" class="form-control" required placeholder="Input Vehicle..."><br>
                        <div class="data">
                            <div>
                                <label for="capacity">
                                    <i class="fa-regular fa-rectangle-list"></i>
                                    Net Capacity (MT)
                                </label><br>
                                <input type="number" autocomplete="off" name="capacity" id="capacity" class="form-control" required placeholder="Input Net Capacity (MT)..."><br>    
                            </div>
                            <div>
                                <label for="type_of_vehicle">
                                    <i class="fa-regular fa-rectangle-list"></i>
                                    Type of Vehicle
                                </label><br>
                                <input type="text" autocomplete="off" name="type_of_vehicle" id="type_of_vehicle" class="form-control" required placeholder="Input Type of Vehicle..."><br>    
                            </div>
                            <div>
                                <label for="ownership_type">
                                    <i class="fa-regular fa-rectangle-list"></i>
                                    Ownership Type
                                </label><br>
                                <select name="ownership_type" id="ownership_type" class="form-control">
                                    <option value="">Select</option>
                                    <option value="LEASED">LEASED</option>
                                    <option value="OWNED">OWNED</option>
                                </select>
                            </div>
                        </div><br>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div>  
                    </form>
                </div>
                <div id="update_vehicle_tab"  style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #dc3545; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <h2>UPDATE VEHICLE FORM</h2><br>
                    <form action="https://script.google.com/macros/s/AKfycbwtUd1A6MGvhh6axwd9DEiutRi0nePAv2sk5YFe49kH41KxWpy3JL3yFGvGbd7MLGMF/exec" method="post">
                        <div></div>
                        <label for="plate_no">
                            <i class="fa-regular fa-rectangle-list"></i>
                            Plate #
                        </label><br>
                        <div class="search_input" id="maintenance_plate_no">
                            <input type="text" autocomplete="off" name="plate_no" id="plate_no" class="form-control" required placeholder="Type to Search Plate #...">
                            <div class="autocom_box">
                            </div>
                            <div class="icon"><i class="fas fa-search"></i></div>
                        </div>        
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div>  
                    </form>
                </div>
                <div class="table" style="max-height: 70vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>PLATE #</th>
                                <th>VEHICLE</th>
                                <th>TYPE OF VEHICLE</th>
                                <th>NET<br>CAPACITY</th>
                                <th>OWNERSHIP TYPE</th>
                                <th>STATUS</th>
                            </thead>
                            <tbody id="vehicle_list">

                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
            </section>
            <!-- vehicle_maintenance_form -->
            <section class="logistic" id="vehicle_maintenance_form">
                <h2>VEHICLE MAINTENANCE</h2>
                <div>
                    <label class="d-flex gap-3">
                        <button type="button" id="vehicle_maintenance_button" class="form-control fw-bold fs-3 bg-success text-white"  style="width: calc((100% - 20px)/2);">
                            VEHICLE MAINTENANCE FORM
                        </button>
                    </label><br>
                </div>
                <div id="vehicle_maintenance_tab"  style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <h2>VEHICLE MAINTENANCE FORM</h2><br>
                    <form action="https://script.google.com/macros/s/AKfycbwtUd1A6MGvhh6axwd9DEiutRi0nePAv2sk5YFe49kH41KxWpy3JL3yFGvGbd7MLGMF/exec" method="post">
                        <label for="plate_no">
                            <i class="fa-regular fa-rectangle-list"></i>
                            Plate #
                        </label><br>
                        <input type="text" autocomplete="off" name="plate_no" id="plate_no" class="form-control form" required placeholder="Input Plate #..."><br>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div>  
                    </form>
                </div>
                <div class="table" style="max-height: 70vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>PLATE #</th>
                                <th>VEHICLE</th>
                                <th>TYPE OF VEHICLE</th>
                                <th>NET<br>CAPACITY</th>
                                <th>OWNERSHIP TYPE</th>
                                <th>STATUS</th>
                            </thead>
                            <tbody id="vehicle_list">

                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
            </section>
            <!-- purchase_request_form -->
            <section class="marketing" id="purchase_request_form">
                <h2>PURCHASE REQUESTS</h2>
                <div>
                    <label class="d-flex gap-3">
                        <button type="button" id="purchase_request_form_button" class="form-control fw-bold fs-3 bg-success text-white" style="width: 50%;">
                            PURCHASE REQUEST FORM
                        </button>
                    </label><br>
                </div>
                <div id="form_tab" style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <form action="https://script.google.com/macros/s/AKfycbxi30lvC_N0zF6nXUDt9vgGJZEuERdNLYFy4ozdaqrtnwTszhuYJCJOA2EP1hV6D8wXBg/exec" method="post">
                        <input type="hidden" name="user" id="user">
                        <input type="hidden" name="department" id="department">
                        <input type="hidden" name="prf_counter" id="prf_counter" value="1">
                        <div id="prf_item_container">
                            <div id="prf_item1">
                                <div>
                                    <div>
                                        <label for="prf_form_no1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            ITM #
                                        </label><br>
                                        <div class="form">
                                            <input type="text" id="prf_form_no1" name="prf_form_no1" autocomplete="off" class="form-control" readonly>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="item1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            Item 1
                                        </label>
                                        <div>
                                            <input type="text" id="item1" name="item1" autocomplete="off" class="form-control" required placeholder="Item Name">
                                        </div>
                                    </div>
                                    <div>
                                        <label for="quantity1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            Quantity
                                        </label>
                                        <div>
                                            <input type="number" id="quantity1" name="quantity1" autocomplete="off" class="form-control" required>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="unit1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            Unit
                                        </label>
                                        <div>
                                            <input type="text" id="unit1" name="unit1" autocomplete="off" class="form-control" required placeholder="ex. kg/pc/box/set">
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div>
                                        <label for="details1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            Details
                                        </label>
                                        <div>
                                            <input type="text" id="details1" name="details1" autocomplete="off" class="form-control" required placeholder="Brand/Unit/Specifications">
                                        </div>
                                    </div>
                                    <div>
                                        <label for="remarks1">
                                            <i class="fa-solid fa-list-ol"></i>
                                            Remarks
                                        </label>
                                        <div>
                                            <input type="text" id="remarks1" name="remarks1" autocomplete="off" class="form-control" required placeholder="Where to use">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="add_item pt-3">
                            <div class="item_buttons">
                                <button type="button" id="remove_item_button" class="form-control">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <button type="button" id="add_item_button" class="form-control">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div> 
                    </form>
                </div>
                <div class="table" style="max-height: 70vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>ITM #</th>
                                <th>REQUEST<br>DATE/TIME</th>
                                <th>ITEM</th>
                                <th>QTY</th>
                                <th>UNIT</th>
                                <th>DETAILS</th>
                                <th>REMARKS</th>
                                <th>SUBMITTED<br>BY</th>
                                <th>STATUS</th>
                            </thead>
                            <tbody id="purchase_request_list">
    
                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
            </section>
            <!-- supplies_warehouse -->
            <section class="logistic" id="supplies_warehouse">
                <h2>SUPPLIES WAREHOUSE</h2>
                <div>
                    <label class="d-flex gap-3">
                        <button type="button" id="withdrawal_form_button" class="form-control fw-bold fs-3 bg-success text-white" style="width: 50%;">
                            WITHDRAWAL SLIP FORM
                        </button>
                    </label><br>
                </div>
                <div id="form_tab" style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <form action="https://script.google.com/macros/s/AKfycbzbi8ofhv1X-Tng2WllOJb_Bdbam8CuhyETWyJY4G56vTzVnFdQxxEI0QNZnjhNMo__/exec" method="post">
                        <input type="hidden" name="user" id="user">
                        <input type="hidden" name="iid_counter" id="iid_counter" value="0">
                        <div>
                            <label for="wsf_form_no">
                                <i class="fa-solid fa-list-ol"></i>
                                WSF #
                            </label><br>
                            <div class="form">
                                <input type="text" id="wsf_form_no" name="wsf_form_no" autocomplete="off" class="form-control" readonly>
                            </div>
                        </div><br>
                        <div id="purpose_container">
                            <label for="purpose">
                                <i class="fa-solid fa-list-ol"></i>
                                Purpose
                            </label>
                        </div>
                        <input type="text" id="purpose" name="purpose" autocomplete="off" class="form-control" required placeholder="Input Purpose">
                        <div class="add_item pt-3" style="position: absolute; top: 50px; right: 300px;">
                            <div class="item_buttons">
                                <button type="button" id="remove_item_button" class="form-control">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <button type="button" id="add_item_button" class="form-control">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div> 
                    </form>
                </div>
                <div class="section_container">
                    <!-- <div style="display: flex; gap: 20px;">
                        <select name="filter_option" id="filter_option" class="form-control" style="width: auto; border: 3px solid #198754;">
                            <option value="">SELECT</option>
                            <option value="WTF #">WTF #</option>
                            <option value="GATE PASS #">GATE PASS #</option>
                            <option value="STEAM #">STEAM #</option>
                            <option value="WAREHOUSE #">WAREHOUSE #</option>
                            <option value="AREA">AREA</option>
                            <option value="SECTION">SECTION</option>
                        </select>
                        <input type="text" id="filter_info" class="form-control" autocomplete="off" style="width: 200px; border: 3px solid #198754;">
                        <button id="search_filter_options" class="form-control" type="button" style="width: auto; background-color: #198754;">
                            <i class="fa-solid fa-magnifying-glass" style="color: #ffffff;"></i>
                        </button>
                    </div> -->
                    <div class="table" style="max-height: 80vh; align-items: start; overflow-y: scroll;">                            
                        <div class="list">
                            <table>
                                <thead style="position: sticky; top: 0; background-color: black;">
                                    <th>#</th>
                                    <th>IID #</th>
                                    <th>STORAGE TYPE</th>
                                    <th>RACK/<BR>PALLET</th>
                                    <th>LEVEL</th>
                                    <th>ITEM</th>
                                    <th>DESCRIPTION</th>
                                    <th>UNIT</th>
                                    <th>AVAILABLE<br>STOCK</th>
                                    <th>SUBMITTED BY</th>
                                </thead>
                                <tbody id="supplies_inventory_list">
    
                                </tbody>
                            </table>
                            <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                        </div>
                    </div><br>
                </div>
            </section>
            <!-- incident_report_form -->
            <section class="logistic" id="incident_report_form">
                <h2>INCIDENT REPORTS</h2>
                <div>
                    <label class="d-flex gap-3">
                        <button type="button" id="incident_report_form_button" class="form-control fw-bold fs-3 bg-success text-white" style="width: 50%;">
                            INCIDENT REPORT FORM
                        </button>
                    </label><br>
                </div>
                <div id="form_tab" style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                    <form action="https://script.google.com/macros/s/AKfycbzFKwCvOpt7feeVGZlRY64h9ANKry_Ap7ivqwdmJyQM_6nY8rT0LzSYlVLjbF-V4Kj7Mg/exec" method="post">
                        <input type="hidden" name="irf_user" id="irf_user">
                        <label for="irf_form_no">
                            <i class="fa-solid fa-list-ol"></i>
                            IRF #
                        </label><br>
                        <div class="form">
                            <input type="text" id="irf_form_no" autocomplete="off" name="irf_form_no" class="form-control" readonly><br>
                        </div>
                        <div class="add_item pt-3" style="position: absolute; top: 70px; right: 20px !important; width: 100px;;">
                            <div class="item_buttons">
                                <button type="button" id="remove_tf_button" class="form-control">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <button type="button" id="add_tf_button" class="form-control">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <input type="hidden" id="irf_counter" name="irf_counter" value="1">
                        <div id="person_involved_containers">
                            <div id="person_involved_container1" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                                <div class="wrapper">
                                    <label for="irf_client1">
                                        <i class="fa-solid fa-user"></i>
                                        Person Involved
                                    </label><br>
                                    <div class="search_input" id="search_irf_client1">
                                        <input type="text" name="irf_client1" id="irf_client1" autocomplete="off" class="form-control" required placeholder="Type to Search Client Name...">
                                        <div class="autocom_box">
                                        </div>
                                        <div class="icon"><i class="fas fa-search"></i></div>
                                    </div>
                                </div>
                                <div>
                                    <label for="irf_department1">
                                        <i class="fa-solid fa-building-user"></i>
                                        Department
                                    </label><br>
                                    <input type="text" id="irf_department1" autocomplete="off" name="irf_department1" class="form-control" required readonly placeholder="Input Department..." style="height: 55px !important;">    
                                </div>
                                <div>
                                    <label for="irf_designation1">
                                        <i class="fa-solid fa-id-card"></i>
                                        Designation
                                    </label><br>
                                    <input type="text" id="irf_designation1" autocomplete="off" name="irf_designation1" class="form-control" required readonly placeholder="Input Designation..." style="height: 55px !important;">   
                                </div>
                            </div>
                        </div><br>
                        <label for="irf_location">
                            <i class="fa-solid fa-map-location-dot"></i>
                            Location
                        </label><br>
                        <input type="text" id="irf_location" autocomplete="off" name="irf_location" class="form-control" required placeholder="Input Location..."><br>
                        <div class="flex">
                            <div>
                                <label for="irf_date">
                                    <i class="fa-regular fa-calendar-days"></i>
                                    Date of Incident
                                </label>
                                <input type="date" autocomplete="off" name="irf_date" id="irf_date" class="form-control" required>
                            </div>
                            <div>
                                <label for="irf_time">
                                    <i class="fa-regular fa-clock"></i>
                                    Time of Incident
                                </label>
                                <input type="time" autocomplete="off" name="irf_time" id="irf_time" class="form-control" required><br>
                            </div>
                        </div>
                        <label for="irf_details">
                            <i class="fa-solid fa-rectangle-list"></i>
                            Incident Details
                        </label><br>
                        <input type="text" id="irf_details" autocomplete="off" name="irf_details" class="form-control" required placeholder="Input Incident Details..."><br>
                        <label for="irf_action_taken">
                            <i class="fa-solid fa-rectangle-list"></i>
                            Action Taken
                        </label><br>
                        <input type="text" id="irf_action_taken" autocomplete="off" name="irf_action_taken" class="form-control" required placeholder="Input Action Taken..."><br>
                        <div class="flex">
                            <div>
                                <label for="irf_report_date">
                                    <i class="fa-regular fa-calendar-days"></i>
                                    Date of Report
                                </label>
                                <input type="date" autocomplete="off" name="irf_report_date" id="irf_report_date" class="form-control" required>
                            </div>
                            <div>
                                <label for="irf_report_time">
                                    <i class="fa-regular fa-clock"></i>
                                    Time of Report
                                </label>
                                <input type="time" autocomplete="off" name="irf_report_time" id="irf_report_time" class="form-control" required><br>
                            </div>
                        </div><br>
                        <div class="buttons">
                            <button type="submit" id="submit_btn" class="form-control" >
                                Submit
                            </button>
                            <button type="reset" id="reset" class="form-control" >
                                Clear
                            </button>
                        </div> 
                    </form>
                </div>
                <div class="table" style="max-height: 70vh; align-items: start; overflow-y: scroll;">                            
                    <div class="list">
                        <table>
                            <thead style="position: sticky; top: 0; background-color: black;">
                                <th>#</th>
                                <th>IRF #</th>
                                <th>INCIDENT<br>DATE/TIME</th>
                                <th>DEPARTMENT</th>
                                <th>PERSON<br>INVOLVE</th>
                                <th>DESIGNATION</th>
                                <th>LOCATION</th>
                                <th>INCIDENT DETAILS</th>
                                <th>REPORT<br>DATE/TIME</th>
                                <th>DURATION<br>REPORT</th>
                            </thead>
                            <tbody id="incident_history_list">

                            </tbody>
                        </table>
                        <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                    </div>
                </div><br>
            </section>
            <!-- settings -->
            <section id="settingsSection">
                <h2>SETTINGS</h2><br>
            </section>
            <!-- help -->
            <section id="helpSection">
                <h2>HELP</h2><br>
            </section>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.37.1/apexcharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="../js/main.js"></script>
    <script src="../js/user7.js"></script>
    <script>
        function convertToPDF() {
            const element = document.getElementById('report_tab');
            const report_date_from = document.getElementById("report_date_from");
            const report_date_to = document.getElementById("report_date_to");
            var report_from = new Date(report_date_from.value)
            var report_to = new Date(report_date_to.value)

            const opt = {
                filename: `Logistics Report ${date_decoder(report_from)} - ${date_decoder(report_to)}`,
                image: { type: 'jpeg', quality: 1 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'letter', orientation: 'landscape' }
            };

            const marginTop = 12.7; // Top margin in mm
            const marginBottom = 12.7; // Bottom margin in mm
            const pageHeight = 215.9; // Adjust the value based on your available space for each page

            const totalPages = Math.ceil(element.clientHeight / pageHeight);

            let promises = [];

            for (let i = 0; i < totalPages; i++) {
                const promise = html2pdf()
                .set(opt)
                .from(element)
                .toContainer()
                .then(() => {
                    const newPosition = -pageHeight * (i + 1) - marginTop;
                    element.style.transform = `translate(0, ${newPosition}px)`;
                });

                promises.push(promise);
            }

            Promise.all(promises)
                .then(() => {
                element.style.transform = 'none';
                html2pdf().set(opt).from(element).save().then(() => {
                    // Call the submit button click event immediately after the PDF is downloaded
                });
            });
        }
    </script>
</body>
</html>