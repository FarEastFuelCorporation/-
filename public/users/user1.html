<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User 1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
    <link rel="shortcut icon" href="../images/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/main-css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" />
    <link href="https://fonts.cdnfonts.com/css/script-mt?styles=95594" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <style>
        /* Width of the scrollbar */
        ::-webkit-scrollbar {
        width: 12px;
        }
    
        /* Handle (the draggable part) */
        ::-webkit-scrollbar-thumb {
        background: #198754; /* Color of the scrollbar handle */
        border-bottom-right-radius: 6px; /* Rounded corners for the handle */
        border-top-right-radius: 5px; /* Rounded corners for the handle */
        }
    
        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
        background: #dc3545; /* Color of the scrollbar handle on hover */
        }
    </style>
</head>
<body>
    <div class="spinner" id="spinner"></div>
    <div class="admin-container">
        <div class="topbar">
            <div class="logo">
                <img src="../images/logo.png" alt="">
                <h2 >FAR EAST FUEL CORPORATION</h2>
            </div>
        </div>
        <div class="sidebar">
            <ul>
                <div id="account_info" style="display: flex; padding: 0 20px; gap: 10px;">
                    <div style="display: flex; justify-content: center; align-items: center;">
                        <img id="profile_picture" src="" alt="">
                    </div>
                    <div id="info" style="display: flex; flex-direction: column; font-size: 14px !important; align-items: center; justify-content: center;">
                        <div id="user_sidebar"></div>
                        <div id="user_sidebar_officer"></div>
                        <div id="user_sidebar_department"></div>
                    </div>
                </div><hr>
                <li class="hover">
                    <a href="#">
                        <i class="fas fa-th-large"></i>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-clipboard-list"></i>
                        Receiving Transactions
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-calendar-check"></i>
                        Accomplishment Report
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-cart-shopping"></i>
                        Purchase Requests
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fas fa-cog"></i>
                        Settings
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fas fa-question"></i>
                        Help
                    </a>
                </li>
                <li>
                    <a href="https://fareastfuelcorporation.github.io/System/">
                        <i class="fa-solid fa-power-off"></i>
                        Logout
                    </a>
                </li>
            </ul>
        </div>
        <div class="main">
            <div class="header_date_time">
                <div class="header_date">
                    <div id="exactDate"></div>
                </div>
                <div class="header_time">
                    <div id="exactTime"></div>    
                </div>
            </div>
            <div class="back_button">
                <button onclick="goBack()">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
            </div>
            <div class="refresh_button">
                            <div class="header_date_time">
                <div class="header_date">
                    <div id="exactDate"></div>
                </div>
                <div class="header_time">
                    <div id="exactTime"></div>    
                </div>
            </div>
            <button onclick="refreshPage()">
                <i class="fa-solid fa-arrows-rotate"></i>
            </button>
        </div>
        <div style="display: flex; position: absolute; top: 60px; right: 20px; z-index: 2; border: 3px solid #dc3545; border-radius: 5px; padding: 5px 20px; background-color: #198754;">
            <label for="month_filter" style="font-weight: bold; color: #ffffff;">FILTER MONTH</label>
            <select name="month_filter" id="month_filter" class="form-control">
                <option value="ALL">ALL</option>
                <option value="JANUARY">JANUARY</option>
                <option value="FEBRUARY">FEBRUARY</option>
                <option value="MARCH">MARCH</option>
                <option value="APRIL">APRIL</option>
                <option value="MAY">MAY</option>
                <option value="JUNE">JUNE</option>
                <option value="JULY">JULY</option>
                <option value="AUGUST">AUGUST</option>
                <option value="SEPTEMBER">SEPTEMBER</option>
                <option value="OCTOBER">OCTOBER</option>
                <option value="NOVEMBER">NOVEMBER</option>
                <option value="DECEMBER">DECEMBER</option>
            </select>
        </div>
        <button id="generate_report_button" style="display: flex; position: absolute; top: 60px; right: 330px; z-index: 2; border: 3px solid #dc3545; border-radius: 5px; padding: 5px 20px; background-color: #198754;">
            <p style="margin: 0; font-weight: bold; color: white;">GENERATE<br>REPORT</p>
        </button>
        <div id="generate_report_tab" style="display: none;">
            <div style="position: absolute; height: 100%; width: 100%; backdrop-filter: blur(5px); z-index: 2;"></div>
            <div style="position: absolute; padding: 20px; width: 500px; background-color: white; z-index: 2; top: 50%; left: 100px; transform: translate(0, -50%); border-radius: 20px; border: 3px solid #dc3545;">
                <button id="close_report_button" style="border: none; position: absolute; right: 20px;">
                    <i class="fa-regular fa-rectangle-xmark" style="color: #ff0000;"></i>
                </button>
                <h2 style="font-weight: bold; margin: 0;">GENERATE REPORT</h2><br>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;" >
                    <div>
                        <label for="report_date_from">From</label>
                        <input type="date" id="report_date_from" class="form-control" style="border: 3px solid #dc3545;">
                    </div>
                    <div>
                        <label for="report_date_to">To</label>
                        <input type="date" id="report_date_to" class="form-control" style="border: 3px solid #dc3545;">
                    </div>
                </div><br>
                <button id="report_generate_button" class="form-control" style="background-color: #198754;">
                    <h4 style="margin: 0; color: white;">Generate</h4>
                </button>
                <button onclick="convertToPDF()" id="report_download_button" class="form-control" style="background-color: #198754; display: none;">
                    <h4 style="margin: 0; color: white;">Download</h4>
                </button>
            </div>
            <input type="hidden" id="page_number" value="1">
            <div id="report_tab_container" style="position: absolute; top: 0; right: 0;">
                <div id="report_tab1" class="report_tab">
                    <img src="../images/logo.png" alt="logo" style="height: 50px;">
                    <img src="../images/logo_name2.png" alt="logo" style="height: 50px; margin-top: 10px;"><hr>
                    <div style="position: relative;">
                        <h1 style="text-align: center; font-weight: bold; font-size: 32px;">WEEKLY REPORT</h1>
                        <h1 style="text-align: center; font-weight: bold;">RECEIVING TRANSACTIONS</h1>
                        <h1 style="text-align: center; font-weight: bold;">LOGISTICS DEPARTMENT</h1>
                        <h3 id="date_covered" style="text-align: center;"></h3><br>
                        <div style="display: flex; position: absolute; right: 0; top: 0;">
                            <h6 id="page_counter1" style="margin-right: 5px;"></h6>
                            <h6 style="margin-right: 5px;">of</h6>
                            <h6 id="page_max_counter"></h6>
                        </div>
                    </div>
                    <div id="table_info">
                        <table>
                            <thead id="report_head">
                                <tr>
                                    <th>WCF #</td>
                                    <th>MTF #</td>
                                    <th>HAULING DATE</th>
                                    <th>ARRIVAL DATE</th>
                                    <th>ARRIVAL TIME</th>
                                    <th>CLIENT</th>
                                    <th>TYPE OF WASTE</th>
                                    <th>TYPE OF VEHICLE</th>
                                    <th>PLATE #</th>
                                </tr>
                            </thead>
                            <tbody id="report_body"></tbody>
                        </table>
                    </div>
                </div>
                <style>
                    .report_tab
                    {
                        width: 1056px;
                        height: 816px;
                        border: 3px solid black;
                        background-color: white;
                        z-index: 4;
                        position: relative;
                        padding: 38px;
                    }
                    
                    .report_tab h1
                    {
                        font-size: 18px;
                        margin: 0;
                    }

                    .report_tab h2
                    {
                        font-size: 16px;
                        margin: 0;
                    }

                    .report_tab h3
                    {
                        font-size: 14px;
                        margin: 0;
                    }

                    .report_tab h4
                    {
                        font-size: 12px;
                        margin: 0;
                    }

                    .report_tab h5
                    {
                        font-size: 10px;
                        margin: 0;
                    }

                    .report_tab table
                    {
                        width: 100%;
                    }

                    .report_tab #report_head tr,
                    .report_tab tbody tr
                    {
                        width: 100%;
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr 1fr 1fr 3fr 2fr 1fr 1fr;
                    }

                    .report_tab #report_head tr th
                    {
                        text-align: center;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        border-top: 1px solid black;
                        border-bottom: 1px solid black;
                        border-right: 1px solid black;
                        font-size: 12px;
                    }

                    .report_tab #report_head tr th:first-child
                    {
                        border: 1px solid black;
                    }

                    .report_tab tbody tr td
                    {
                        text-align: center;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        border-bottom: 1px solid black;
                        border-right: 1px solid black;
                        font-size: 10px;
                    }

                    .report_tab tbody tr td:first-child
                    {
                        border-bottom: 1px solid black;
                        border-right: 1px solid black;
                        border-left: 1px solid black;
                    }
                </style>
            </div>
        </div>
        <!-- dashboard -->
        <section id="dashboard_section">
            <h2>DASHBOARD</h2><br>
            <h2>RECEIVING SUMMARY</h2>
            <div class="cards2">
                <div class="card">
                    <div class="card-content">
                        <div class="number" id="to_received"></div>
                        <div class="card-name">Travel Transaction</div>
                    </div>
                    <div class="icon-box">
                        <i class="fa-solid fa-truck-arrow-right"></i>
                    </div>
                </div>
                <div class="card">
                    <div class="card-content">
                        <div class="number" id="pending"></div>
                        <div class="card-name">Pending Transaction</div>
                    </div>
                    <div class="icon-box">
                        <i class="fa-solid fa-clipboard-list"></i>
                    </div>
                </div>
                <div class="card">
                    <div class="card-content">
                        <div class="number" id="received"></div>
                        <div class="card-name">Received</div>
                    </div>
                    <div class="icon-box">
                        <i class="fa-solid fa-clipboard-check"></i>
                    </div>
                </div>
                <div style="position: relative;">
                    <div id="pieChart" style="position: absolute; margin-top: -40px;">
                    </div>
                </div>
            </div><br>
            <h2>PENDING TRANSACTIONS</h2>
            <div class="table" style="max-height: 40vh; align-items: start; overflow-y: scroll;">                            
                <div class="list">
                    <table>
                        <thead style="position: sticky; top: 0; background-color: black;">
                            <th>#</th>
                            <th>LTF / MTF #</th>
                            <th>MTF #</th>
                            <th>HAULING<br>DATE/TIME</th>
                            <th>CLIENT</th>
                            <th>WASTE<br>CODE</th>
                            <th>WASTE DESCRIPTION</th>
                            <th>TYPE OF VEHICLE</th>
                            <th>PLATE #</th>
                            <th>DRIVER</th>
                        </thead>
                        <tbody id="pending_list"></tbody>
                    </table>
                    <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                </div>
            </div><br>
            <h2>RECEIVING HISTORY</h2>
            <div class="table" style="max-height: 40vh; align-items: start; overflow-y: scroll;">                            
                <div class="list">
                    <table>
                        <thead style="position: sticky; top: 0; background-color: black;">
                            <th>#</th>
                            <th>WCF #</th>
                            <th>MTF #</th>
                            <th>TRUCK SCALE #</th>
                            <th>PULL OUT FORM #</th>
                            <th>HAULING<br>DATE/TIME</th>
                            <th>CLIENT</th>
                            <th>WASTE<br>CODE</th>
                            <th>WASTE DESCRIPTION</th>
                            <th>NET WEIGHT</th>
                            <th>PLATE #</th>
                            <th>DRIVER</th>
                            <th>WEIGH-IN<BR>DATE/TIME</th>
                            <th>WEIGH-OUT<BR>DATE/TIME</th>
                            <th>DURATION</th>
                        </thead>
                        <tbody id="received_list">

                        </tbody>
                    </table>
                    <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                </div>
            </div>
        </section>
        <!-- WASTE COLLECTION FORM -->
        <section id="waste_collection_form">
            <h2>RECEIVING TRANSACTIONS</h2><br>
            <form id="form_id" action="https://script.google.com/macros/s/AKfycbyEFX6X0V7kp-vDWsZujfSvVCTXCzXKIofaoM4ENxRHWQVQIaVgEwiwfmmHljxjFKqH/exec" method="post">
                <input type="hidden" name="user" id="user">
                <input type="hidden" name="mtf_form_no" id="mtf_form_no">
                <input type="hidden" name="process" id="process">
                <input type="hidden" name="ltf_form_no" id="ltf_form_no">
                <input type="hidden" name="waste_description" id="waste_description">
                <input type="hidden" name="driver_id" id="driver_id">
                <input type="hidden" name="client_id" id="client_id">
                <input type="hidden" name="hauling_date" id="hauling_date">
                <input type="hidden" name="status" id="status" value="AVAILABLE">
                <div class="wcf_form">
                    <div>
                        <label for="wcf_form_no">
                            <i class="fa-solid fa-list-ol"></i>
                            WCF #
                        </label><br>
                        <div class="form">
                            <input type="text" id="wcf_form_no" autocomplete="off" name="wcf_form_no" class="form-control" readonly><br>
                        </div>
                    </div>
                </div>
                <div class="wcf_form">
                    <div>
                        <label for="search_ltf_form_no">
                            <i class="fa-solid fa-list-ol"></i>
                            Search LTF / MTF #
                        </label>
                        <div class="wcf_form">
                            <div class="form">
                                <input type="text" id="search_ltf_form_no" autocomplete="off" name="search_ltf_form_no" class="form-control"><br>
                            </div>
                            <div>
                                <button id="search_ltf_form_no_button" class="form-control" type="button">
                                    <i class="fa-solid fa-magnifying-glass" style="color: #ffffff;"></i>
                                </button>
                            </div>
                            <div>
                                <button id="clear_ltf_form_no_button" type="button" class="form-control">
                                    <i class="fa-solid fa-rectangle-xmark" style="color: #ffffff;"></i>
                                </button>
                            </div>
                            <div>
                                <button id="direct_receiving_button" type="button" class="form-control text-white" style="max-width: fit-content !important;">
                                    Direct Receiving
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="search_ltf_result"></div>
                <div id="wcf_data">
                    <div class="plate_and_driver">
                        <div class="wrapper">
                            <label for="plate_no">
                                <i class="fa-solid fa-truck"></i>
                                Plate #
                            </label><br>
                            <div class="search_input" id="search_plate_no">
                                <input type="text" autocomplete="off" name="plate_no" id="plate_no" class="form-control" required placeholder="Type to Search Plate #...">
                                <div class="autocom_box">
                                </div>
                                <div class="icon"><i class="fas fa-search"></i></div>
                            </div>
                        </div>                         
                        <div class="wrapper">
                            <label for="plate_no">
                                <i class="fa-solid fa-truck"></i>
                                Type of Vehicle
                            </label><br>
                            <div id="type_of_vehicle_container">
                            </div>
                        </div>                         
                        <div class="wrapper">
                            <label for="driver">
                                <i class="fa-solid fa-id-card"></i>
                                Driver
                            </label><br>
                            <div class="search_input" id="search_driver">
                                <input type="text" autocomplete="off" name="driver" id="driver" class="form-control" required placeholder="Type to Search Driver Name...">
                                <div class="autocom_box">
                                </div>
                                <div class="icon"><i class="fas fa-search"></i></div>
                            </div>
                        </div>
                    </div><br>
                    <div class="time_in_out">
                        <div class="time_in">
                            <label for="time_in">
                                <i class="fa-solid fa-right-to-bracket"></i>
                                IN - <br>Date and Time
                            </label>
                            <input type="date" autocomplete="off" name="date_in" id="date_in" class="form-control" required>
                            <input type="time" autocomplete="off" name="time_in" id="time_in" class="form-control" required><br>  
                        </div>
                        <div class="time_out">
                            <label for="time_out">
                            <i class="fa-solid fa-right-from-bracket"></i>
                                OUT - <br>Date and Time
                            </label>
                            <input type="date" autocomplete="off" name="date_out" id="date_out" class="form-control" required>
                            <input type="time" autocomplete="off" name="time_out" id="time_out" class="form-control" required><br>
                        </div>
                    </div>
                    <div style="width: calc((100%)); display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                        <div>
                            <label for="pull_out_form">
                                <i class="fa-solid fa-file-invoice"></i>
                                Pull Out Form #
                            </label>
                            <input type="text" autocomplete="off" name="pull_out_form" id="pull_out_form" class="form-control" placeholder="Type Pull Out Form #" required>
                        </div>
                        <div>
                            <label for="ptt">
                                <i class="fa-solid fa-file-invoice"></i>
                                PTT #
                            </label>
                            <input type="text" autocomplete="off" name="ptt" id="ptt" class="form-control" placeholder="Type PTT #" required>
                        </div>
                        <div>
                            <label for="manifest">
                                <i class="fa-solid fa-file-invoice"></i>
                                Manifest #
                            </label>
                            <input type="text" autocomplete="off" name="manifest" id="manifest" class="form-control" placeholder="Type Manifest #" required>
                        </div>
                    </div><br>
                    <div style="width: calc((100%)); display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px;">
                        <div>
                            <label for="gross_weight">
                                <i class="fa-solid fa-weight-scale"></i>
                                Client Weight (Kg)
                            </label>
                            <input type="number" autocomplete="off" name="client_weight" id="client_weight" class="form-control" placeholder="Type Client Weight" required>
                        </div>
                        <div>
                            <label for="submit_to">
                                <i class="fa-solid fa-arrow-up-right-from-square"></i>
                                Submit To
                            </label><br>
                            <select name="submit_to" id="submit_to" class="form-control" required>
                                <option value="">SELECT</option>
                                <option value="SORTING">SORTING</option>
                                <option value="WAREHOUSE">WAREHOUSE</option>
                                <option value="ROTARY">ROTARY</option>
                                <option value="FURNACE">FURNACE</option>
                                <option value="THERMAL GASIFIER">THERMAL GASIFIER</option>
                                <option value="ACCOUNTING">ACCOUNTING</option>
                            </select>
                        </div>
                    </div><br>
                    <label for="gross_weight">
                        <i class="fa-solid fa-weight-scale"></i>
                        Truck Scaling
                    </label>
                    <div class="items">
                        <div>
                            <label for="gross_weight">Truck Scale #</label>
                            <input type="text" autocomplete="off" name="truck_scale_no" id="truck_scale_no" class="form-control" placeholder="Type Truck Scale #" required>
                        </div>
                        <div>
                            <label for="gross_weight">Gross Weight (Kg)</label>
                            <input onkeyup="weight_calculator()" type="number" autocomplete="off" name="gross_weight" id="gross_weight" class="form-control" placeholder="Type Gross Weight" required>
                        </div>
                        <div>
                            <label for="tare_weight">Tare Weight (Kg)</label>
                            <input  onkeyup="weight_calculator()" type="number" autocomplete="off" name="tare_weight" id="tare_weight" class="form-control" placeholder="Type Gross Weight" required>
                        </div>
                        <div>
                            <label for="net_weight">Net Weight (Kg)</label>
                            <input type="number" autocomplete="off" name="net_weight" id="net_weight" class="form-control" placeholder="Auto Calculate" required readonly>
                        </div>    
                    </div><br>
                    <label for="remarks">
                        <i class="fa-brands fa-rocketchat"></i>
                        Remarks
                    </label><br>
                    <input class="form-control" autocapitalize="words" autocomplete="off" name="remarks" id="remarks" type="text" placeholder="Type your Remarks"><br>
                    <div class="buttons">
                        <button type="submit" id="submit_btn" class="form-control" >
                            Submit
                        </button>
                        <button type="reset" id="reset" class="form-control" >
                            Clear
                        </button>
                    </div>    
                </div>
            </form>
        </section>
        <!-- accomplishment_report -->
<section class="marketing" id="accomplishment_report">
    <h2>ACCOMPLISHMENT REPORT</h2>
    <div>
      <label class="d-flex gap-3">
        <button
          type="button"
          id="new_accomplishment_report_button"
          class="form-control fw-bold fs-3 bg-success text-white"
        >
          <h2>NEW</h2>
        </button>
        <button
          type="button"
          id="update_accomplishment_report_button"
          class="form-control fw-bold fs-3 bg-danger text-white"
        >
          <h2>UPDATE</h2>
        </button> </label
      ><br />
    </div>
    <div
      class="table"
      style="max-height: 70vh; align-items: start; overflow: scroll"
    >
      <div class="list">
        <table>
          <thead style="position: sticky; top: 0; background-color: black">
            <th>#</th>
            <th>AR ID #</th>
            <th>TASK ID #</th>
            <th>TASKS</th>
            <th>ACCOMPLISHMENT</th>
            <th>START<br />DATE/TIME</th>
            <th>FINISH<br />DATE/TIME</th>
            <th>DURATION</th>
            <th style="width: 150px">PERCENTAGE</th>
          </thead>
          <tbody id="accomplishment_report_list"></tbody>
        </table>
        <div class="text-center text_end">>>>>>>>>> END OF LIST <<<<<<<<<<</div>
      </div>
    </div>
    <br />
    <div
      id="new_accomplishment_form_tab"
      style="
        display: none;
        position: absolute;
        top: 140px;
        right: 20px;
        width: calc(100% - 40px);
        height: 75vh;
        padding: 20px;
        border: 3px solid #198754;
        border-radius: 10px;
        background-color: white;
        overflow: scroll;
        z-index: 2;
      "
    >
      <h2>NEW ACCOMPLISHMENT REPORT FORM</h2>
      <br />
      <form
        action="https://script.google.com/macros/s/AKfycbwgEc6ij6bHanbwPn4NH4Nak0uCfIC7vCwsm-sGK19EPCuVCHktMubyxfeu-bgd-46x6Q/exec"
        method="post"
      >
        <input type="hidden" name="user" id="user" />
        <input type="hidden" name="user_department" id="user_department" />
        <div class="row">
          <div class="col-12 col-lg-6">
            <label for="task">
              <i class="fa-solid fa-briefcase"></i>
              Task </label
            ><br />
            <input
              type="text"
              name="task"
              id="task"
              autocomplete="off"
              class="form-control"
              required
              placeholder="Input Task Name..."
            /><br />
            <label for="percentage">
              <i class="fa-solid fa-hourglass-half"></i>
              Percentage </label
            ><br />
            <div class="range">
              <div class="sliderValue">
                <span id="sliderValue">0%</span>
              </div>
              <div class="field">
                <div class="value left">0%</div>
                <input
                  type="range"
                  name="percentage"
                  id="percentage"
                  autocomplete="off"
                  min="0"
                  max="100"
                  value="0"
                  step="1"
                  required
                />
                <div class="value right">100%</div>
              </div>
            </div>
            <br />
            <label for="accomplishment">
              <i class="fa-solid fa-calendar-check"></i>
              Accomplishment </label
            ><br />
            <input
              type="text"
              name="accomplishment"
              id="accomplishment"
              autocomplete="off"
              class="form-control"
              required
              placeholder="Input Accomplishment..."
            /><br />
            <div class="row">
              <div class="col-6">
                <label for="ar_date_start">
                  <i class="fa-solid fa-calendar-days"></i>
                  Date/Time Start
                </label>
                <div>
                  <input
                    type="date"
                    id="ar_date_start"
                    name="ar_date_start"
                    class="form-control"
                    required
                  />
                  <input
                    type="time"
                    id="ar_time_start"
                    name="ar_time_start"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="col-6">
                <label for="ar_date_finished">
                  <i class="fa-solid fa-calendar-days"></i>
                  Date/Time Finished
                </label>
                <div>
                  <input
                    type="date"
                    id="ar_date_finished"
                    name="ar_date_finished"
                    class="form-control"
                    readonly
                  />
                  <input
                    type="time"
                    id="ar_time_finished"
                    name="ar_time_finished"
                    class="form-control"
                    readonly
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="buttons">
            <button type="submit" id="submit_btn" class="form-control">
              Submit
            </button>
            <button type="reset" id="reset" class="form-control">Clear</button>
          </div>
        </div>
      </form>
    </div>
    <div
      id="update_accomplishment_form_tab"
      style="
        display: none;
        position: absolute;
        top: 140px;
        right: 20px;
        width: calc(100% - 40px);
        height: 75vh;
        padding: 20px;
        border: 3px solid #dc3545;
        border-radius: 10px;
        background-color: white;
        overflow: scroll;
        z-index: 2;
      "
    >
      <h2>UPDATE ACCOMPLISHMENT REPORT FORM</h2>
      <br />
      <form
        action="https://script.google.com/macros/s/AKfycbyfpK6rKZY6WEsQuvAuOSbIrVYUWJHECzX75IY2Et12qptEiuISIVEr2t5yYj_Uju0/exec"
        method="post"
      >
        <input type="hidden" name="user" id="user" />
        <input type="hidden" name="user_department" id="user_department" />
        <div style="display: flex; gap: 20px">
          <div>
            <label for="task_id">
              <i class="fa-solid fa-bars-progress"></i>
              Task ID </label
            ><br />
            <input
              type="text"
              name="task_id"
              id="task_id"
              autocomplete="off"
              class="form-control form"
              required
            />
          </div>
          <div style="display: flex; align-items: end">
            <button
              id="task_id_button"
              type="button"
              class="form-control"
              style="width: 60px; height: 60px"
            >
              <i class="fa-solid fa-magnifying-glass" style="color: #ffffff"></i>
            </button>
          </div>
        </div>
        <br />
        <div class="row" style="display: none" id="ar_details">
          <div class="col-12 col-lg-6">
            <label for="task">
              <i class="fa-solid fa-briefcase"></i>
              Task </label
            ><br />
            <input
              type="text"
              name="task"
              id="task"
              autocomplete="off"
              class="form-control"
              required
              placeholder="Input Task Name..."
              readonly
            /><br />
            <label for="percentage">
              <i class="fa-solid fa-hourglass-half"></i>
              Percentage </label
            ><br />
            <div class="range">
              <div class="sliderValue">
                <span id="sliderValue">0%</span>
              </div>
              <div class="field">
                <div class="value left">0%</div>
                <input
                  type="range"
                  name="percentage"
                  id="percentage"
                  autocomplete="off"
                  min="0"
                  max="100"
                  value="0"
                  step="1"
                  required
                />
                <div class="value right">100%</div>
              </div>
            </div>
            <br />
            <label for="accomplishment">
              <i class="fa-solid fa-calendar-check"></i>
              Accomplishment </label
            ><br />
            <input
              type="text"
              name="accomplishment"
              id="accomplishment"
              autocomplete="off"
              class="form-control"
              required
              placeholder="Input Accomplishment..."
            /><br />
            <div class="row">
              <div class="col-6">
                <label for="ar_date_start">
                  <i class="fa-solid fa-calendar-days"></i>
                  Date/Time Start
                </label>
                <div>
                  <input
                    type="date"
                    id="ar_date_start"
                    name="ar_date_start"
                    class="form-control"
                    readonly
                  />
                  <input
                    type="time"
                    id="ar_time_start"
                    name="ar_time_start"
                    class="form-control"
                    readonly
                  />
                </div>
              </div>
              <div class="col-6">
                <label for="ar_date_finished">
                  <i class="fa-solid fa-calendar-days"></i>
                  Date/Time Finished
                </label>
                <div>
                  <input
                    type="date"
                    id="ar_date_finished"
                    name="ar_date_finished"
                    class="form-control"
                    readonly
                  />
                  <input
                    type="time"
                    id="ar_time_finished"
                    name="ar_time_finished"
                    class="form-control"
                    readonly
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="buttons">
            <button type="submit" id="submit_btn" class="form-control">
              Submit
            </button>
            <button type="reset" id="reset" class="form-control">Clear</button>
          </div>
        </div>
      </form>
    </div>
  </section>
        <!-- purchase_request_form -->
        <section class="marketing" id="purchase_request_form">
            <h2>PURCHASE REQUESTS</h2>
            <div>
                <label class="d-flex gap-3">
                    <button type="button" id="purchase_request_form_button" class="form-control fw-bold fs-3 bg-success text-white" style="width: 50%;">
                        PURCHASE REQUEST FORM
                    </button>
                </label><br>
            </div>
            <div id="form_tab" style="display: none; position: absolute; top: 140px; right: 20px; width: calc(100% - 40px); height: 75vh; padding: 20px; border: 3px solid #198754; border-radius: 10px; background-color: white; overflow: scroll; z-index: 2;">
                <form action="https://script.google.com/macros/s/AKfycbxi30lvC_N0zF6nXUDt9vgGJZEuERdNLYFy4ozdaqrtnwTszhuYJCJOA2EP1hV6D8wXBg/exec" method="post">
                    <input type="hidden" name="user" id="user">
                    <input type="hidden" name="department" id="department">
                    <input type="hidden" name="prf_counter" id="prf_counter" value="1">
                    <div id="prf_item_container">
                        <div id="prf_item1">
                            <div>
                                <div>
                                    <label for="prf_form_no1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        ITM #
                                    </label><br>
                                    <div class="form">
                                        <input type="text" id="prf_form_no1" name="prf_form_no1" autocomplete="off" class="form-control" readonly>
                                    </div>
                                </div>
                                <div>
                                    <label for="item1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        Item 1
                                    </label>
                                    <div>
                                        <input type="text" id="item1" name="item1" autocomplete="off" class="form-control" required placeholder="Item Name">
                                    </div>
                                </div>
                                <div>
                                    <label for="quantity1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        Quantity
                                    </label>
                                    <div>
                                        <input type="number" id="quantity1" name="quantity1" autocomplete="off" class="form-control" required>
                                    </div>
                                </div>
                                <div>
                                    <label for="unit1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        Unit
                                    </label>
                                    <div>
                                        <input type="text" id="unit1" name="unit1" autocomplete="off" class="form-control" required placeholder="ex. kg/pc/box/set">
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <label for="details1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        Details
                                    </label>
                                    <div>
                                        <input type="text" id="details1" name="details1" autocomplete="off" class="form-control" required placeholder="Brand/Unit/Specifications">
                                    </div>
                                </div>
                                <div>
                                    <label for="remarks1">
                                        <i class="fa-solid fa-list-ol"></i>
                                        Remarks
                                    </label>
                                    <div>
                                        <input type="text" id="remarks1" name="remarks1" autocomplete="off" class="form-control" required placeholder="Where to use">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="add_item pt-3">
                        <div class="item_buttons">
                            <button type="button" id="remove_item_button" class="form-control">
                                <i class="fa-solid fa-minus"></i>
                            </button>
                            <button type="button" id="add_item_button" class="form-control">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="buttons">
                        <button type="submit" id="submit_btn" class="form-control" >
                            Submit
                        </button>
                        <button type="reset" id="reset" class="form-control" >
                            Clear
                        </button>
                    </div> 
                </form>
            </div>
            <div class="table" style="max-height: 70vh; align-items: start; overflow-y: scroll;">                            
                <div class="list">
                    <table>
                        <thead style="position: sticky; top: 0; background-color: black;">
                            <th>#</th>
                            <th>ITM #</th>
                            <th>REQUEST<br>DATE/TIME</th>
                            <th>ITEM</th>
                            <th>QTY</th>
                            <th>UNIT</th>
                            <th>DETAILS</th>
                            <th>REMARKS</th>
                            <th>SUBMITTED<br>BY</th>
                            <th>STATUS</th>
                            <th></th>
                        </thead>
                        <tbody id="purchase_request_list">

                        </tbody>
                    </table>
                    <div class="text-center text_end">>>>>>>>>>> END OF LIST <<<<<<<<<<</div>
                </div>
            </div><br>
        </section>
        <!-- settings -->
        <section id="settingsSection">
            <h2>SETTINGS</h2><br>
        </section>
        <!-- help -->
        <section class="all" id="helpSection">
            <h2>HELP</h2><br>
            <form action="https://script.google.com/macros/s/AKfycbxikTLqNb0ote-pFoUabyNVphtpqvh1rWSi7bNrAkncoP6-a3BTXhn9jVu8Ka9YXjVA/exec" method="post">
                <h2>VOID TRANSACTIONS</h2><br>
                <input type="hidden" name="user" id="user">
                <div style="font-size: 20px !important;">
                    <div>
                        <label for="transaction_no">
                            <i class="fa-solid fa-list-ol"></i>
                            Transaction #
                        </label><br>
                        <div class="form">
                            <input type="text" id="transaction_no" autocomplete="off" name="transaction_no" class="form-control form" required style="border: 3px solid #198754; max-width: 250px;"><br>
                        </div>
                    </div>
                    <div>
                        <label for="reason">
                            <i class="fa-solid fa-list-ol"></i>
                            Reason for Void
                        </label><br>
                        <div class="form">
                            <input type="text" id="reason" autocomplete="off" name="reason" class="form-control" required style="border: 3px solid #198754;"><br>
                        </div>
                    </div>
                    <div class="buttons" style="display: flex; gap: 20px;">
                        <button type="submit" id="submit_btn" class="form-control bg-success text-white" style="width: 200px; font-size: 20px !important;">
                            Submit
                        </button>
                        <button type="reset" id="reset" class="form-control bg-danger text-white" style="width: 200px; font-size: 20px !important;">
                            Clear
                        </button>
                    </div> 
                </div>
            </form>
        </section>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.37.1/apexcharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="../js/main.js"></script>
    <script src="../js/user1.js"></script>
    <script>
        function convertToPDF() {
            const report_date_from = document.getElementById("report_date_from");
            const report_date_to = document.getElementById("report_date_to");
            var report_from = new Date(report_date_from.value)
            var report_to = new Date(report_date_to.value)

            const marginTop = 12.7; // Top margin in mm
            const marginBottom = 12.7; // Bottom margin in mm
            const pageHeight = 215.9; // Adjust the value based on your available space for each page

            const pages =  document.querySelectorAll(".report_tab")

            pages.forEach((page, i) => {
                const totalPages = Math.ceil(page.clientHeight / pageHeight);

                const opt = {
                    filename: `Logistics Receiving Transaction Report ${date_decoder(report_from)} - ${date_decoder(report_to)} Page ${i + 1} of ${pages.length}`,
                    image: { type: 'jpeg', quality: 1 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'mm', format: 'letter', orientation: 'landscape' }
                };
    
                let promises = [];
    
                for (let i = 0; i < totalPages; i++) {
                    const promise = html2pdf()
                    .set(opt)
                    .from(page)
                    .toContainer()
                    .then(() => {
                        const newPosition = -pageHeight * (i + 1) - marginTop;
                        page.style.transform = `translate(0, ${newPosition}px)`;
                    });
    
                    promises.push(promise);
                }
    
                Promise.all(promises)
                    .then(() => {
                        page.style.transform = 'none';
                    html2pdf().set(opt).from(page).save().then(() => {
                        // Call the submit button click event immediately after the PDF is downloaded
                    });
                });
            })
        }
    </script>
        <script>

            const accomplishment_report_section = document.querySelector("#accomplishment_report");
            const new_accomplishment_form_tab = accomplishment_report_section.querySelector("#new_accomplishment_form_tab");
            const slideValue = new_accomplishment_form_tab.querySelector("#sliderValue")
            const inputSlider = new_accomplishment_form_tab.querySelector("#percentage")
            const ar_date_finished = new_accomplishment_form_tab.querySelector("#ar_date_finished")
            const ar_time_finished = new_accomplishment_form_tab.querySelector("#ar_time_finished")
    
            inputSlider.oninput = (() => {
                let value = inputSlider.value;
                slideValue.textContent = value + "%";
                slideValue.style.left = (value/2) + "%";
                if(value == 100){
                    ar_date_finished.removeAttribute('readonly');
                    ar_date_finished.setAttribute('required', true);
                    ar_time_finished.removeAttribute('readonly');
                    ar_time_finished.setAttribute('required', true);
                } else {
                    ar_date_finished.setAttribute('readonly', true);
                    ar_date_finished.removeAttribute('required');
                    ar_time_finished.setAttribute('readonly', true);
                    ar_time_finished.removeAttribute('required');
                }
            })
    
            const update_accomplishment_form_tab = accomplishment_report_section.querySelector("#update_accomplishment_form_tab");
            const slideValue2 = update_accomplishment_form_tab.querySelector("#sliderValue")
            const inputSlider2 = update_accomplishment_form_tab.querySelector("#percentage")
            const ar_date_finished2 = update_accomplishment_form_tab.querySelector("#ar_date_finished")
            const ar_time_finished2 = update_accomplishment_form_tab.querySelector("#ar_time_finished")
            inputSlider2.oninput = (() => {
                let value = inputSlider2.value;
                slideValue2.textContent = value + "%";
                slideValue2.style.left = (value/2) + "%";
                if(value == 100){
                    ar_date_finished2.removeAttribute('readonly');
                    ar_date_finished2.setAttribute('required', true);
                    ar_time_finished2.removeAttribute('readonly');
                    ar_time_finished2.setAttribute('required', true);
                } else {
                    ar_date_finished2.setAttribute('readonly', true);
                    ar_date_finished2.removeAttribute('required');
                    ar_time_finished2.setAttribute('readonly', true);
                    ar_time_finished2.removeAttribute('required');
                }
            })
    
        </script>
</body>
</html>